# main training loop and logic for label evolution